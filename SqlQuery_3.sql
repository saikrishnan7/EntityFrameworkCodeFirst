DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'CodeFirstVidzy.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201910312352515_InitialModel'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [tinyint] NOT NULL,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime],
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [tinyint] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201910312352515_InitialModel', N'CodeFirstVidzy.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D64AB297AD61EF22EB2445D04D1CC449D05B404B63872845A92415D85BF4C97AE823F5153AD4BF48C996BD81B72D02043639339C9F8FC399F1DF7FFE35FAB00A99F30242D2888FDD93C1B1EB00F7A380F2E5D84DD4E2CD3BF7C3FB6FBF195D04E1CA792CE8DE6A3AE4E472EC3E2B150F3D4FFACF10123908A92F22192DD4C08F428F0491777A7CFCA37772E2018A705196E38CEE12AE6808E917FC3A89B80FB14A08BB8E0260325FC79D592AD5B92121C898F830762748714985548F34F8BC769D3346096A3103B6701DC279A488421D870F12664A447C398B7181B0FB750C48B7204C42AEFBB022EF6BC6F1A936C3AB180B517E225514EE28F0E46DEE17CF64DFCBBB6EE937F4DC057A58ADB5D5A9F7C6EE4FC0055A6E9E349C30A1A94CCF0E52FA23A7B97A546200A1A2FF9020612A1130E6902841D891739BCC19F57F86F57DF42BF0314F18AB6B86BAE15E6301976E45148350EB3B58E4FA5E05AEE335F93C93B164ABF164C67C5C2B34F606CF26730665DCBD8DECFA7F2100C18377C075AEC9EA13F0A57A1EBBF8D1752EE90A82622597FAC0295E19645222B10FB9212F7499FADA380E3D0A91749D3B60E9B67CA67186E441BAF5948600092E4514DE45AC60C9D79FEE8958824285A396CD599408DF5066E455A8D8889554D20E5849E9FFB358B9E2EAED690B586A86CF5424003D0B8228086E895220B89601A9EBBE0EB08C43104640249C13559EA53FDFD370074C1690DB179305EC5A315900B60F26CFA48C7C9AEA500765717ED39C0B1E389B94C91C5F1A81CE4720D218A187278FDD1F2CFF74082C6F5C25304FAB1B058EBC9A35F6C5C3E74F118AD8AA0CFD9C2EC24AB55C427CD9F27B28736098BA6BA1335046482B3F3755B74C6FB21759CA62CF5D69B0D72C356494D0A991B441CBBCEE5B825BEA5BA9EAF5145184B326A2D0D1CC264DB35AF05B06B12A5EBCAC7A29AA1CAFA3CC195D9338C694502B7BF2156796D73C6F66BB17046126C3F3654B5D506A5B9E84098E2CC1D8AD257A4C25644E74529A04A145D6806C079E8AA31AA8B42355A0AC20D79F3396B602C5145039EF12ED09313DA7A68119629B2FAD360923A2E59D98442C0979D75BB3893BCBFC75FE6CC59630F20CC54DD778966F0C8C9A9EEE1587FCCE7C411CB23CB07B1C3AF8BE761CBA24349ED7BAA0C6C6E1E3DACC4C2DC12DF3EEE6089664AD716ABD343AAFB6D5B4468AB65DD22BC099A8B6306B979407EFA8539EF3F7D42915B2A34EE6E36147D17A434C921243E55B62BC19A33C7FEFD03F17093D23711DD4FD051D85C97CB6960AC2812618CC7E63134611B515C135E17401526525BB8B6DECA9D186FF7B5A624FCA80F5E98B0FDE7428CAD754BBF50B7A54FE4284FF4CC47721597D5F9764B70B3BB67E077747EA8AAD5DD6617CD5ABB50AF0B34A5BABD773FBDE50DC902A6DE2AE1CB63D5CD531B5A059FDC9150F6035767F4F9986CED52F4F05DF913315984086CEB1F3C7CEC1ACD4362E500F050ADE1D14D8AF2F6D7DF2CCF6637B437A62BDB4537E8E1854E09CF9592E9D10E993C0F69A7E86369E9E777DA60A7DFA583DB98505087D1D09C3D74A2A81EF9555D1DC0ACA7D1A13D6B0DA7E72FB24116D5229CFDC398718B8CE0EB6817D4EDB546194A20DF76E734067AFBF05386D75492D7476D45A03F63F034EFF501E16389BCAC057074EFB90C86ECC7B4C81BA8740591588CFDA5CA7A72C2B76CC425A0744DDF3A136C9ED839A76C95D8AD7373BCFE83061EB90AA9C2E6D9E5575743876C2B7DADEAD33AA86D9661FD67F3CD5CBD8620EB6C5D8F6D6C94E52D6ACE550C6EE308BB3FB25BCA1B55F25314348BAAC44E8DF2839F88DBB59D25CF14554240943A382C42866AE4111AC20C9995074417C85DB3E4899FE30F04858822417E11C822B3E4D549C283419C2396BFCD0A053CDA6F3D3816353E7D1344E87FAAF6102AA4975113CE51F13CA8252EFCB965AAA4384CE6179B9AF63A974D9BF5C97926E22DE5350EEBE32F5DE4318331426A77C465E601FDD1E247C8225F1D745DBDB2D647B209A6E1F9D53B2142494B98C8A1FBF22868370F5FE1FC846384A9C1F0000 , N'6.3.0')
END

IF @CurrentMigration < '201910312355112_AddSomeDataIntoGenresTable'
BEGIN
    Insert into Genres(Id, Name) Values(1, 'Horror')
    Insert into Genres(Id, Name) Values(2, 'Thriller')
    Insert into Genres(Id, Name) Values(3, 'Romance')
    Insert into Genres(Id, Name) Values(4, 'Comedy')
    Insert into Genres(Id, Name) Values(5, 'Drama')
    Insert into Genres(Id, Name) Values(6, 'Action')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201910312355112_AddSomeDataIntoGenresTable', N'CodeFirstVidzy.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D64AB297AD61EF22EB2445D04D1CC449D05B404B63872845A92415D85BF4C97AE823F5153AD4BF48C996BD81B72D02043639339C9F8FC399F1DF7FFE35FAB00A99F30242D2888FDD93C1B1EB00F7A380F2E5D84DD4E2CD3BF7C3FB6FBF195D04E1CA792CE8DE6A3AE4E472EC3E2B150F3D4FFACF10123908A92F22192DD4C08F428F0491777A7CFCA37772E2018A705196E38CEE12AE6808E917FC3A89B80FB14A08BB8E0260325FC79D592AD5B92121C898F830762748714985548F34F8BC769D3346096A3103B6701DC279A488421D870F12664A447C398B7181B0FB750C48B7204C42AEFBB022EF6BC6F1A936C3AB180B517E225514EE28F0E46DEE17CF64DFCBBB6EE937F4DC057A58ADB5D5A9F7C6EE4FC0055A6E9E349C30A1A94CCF0E52FA23A7B97A546200A1A2FF9020612A1130E6902841D891739BCC19F57F86F57DF42BF0314F18AB6B86BAE15E6301976E45148350EB3B58E4FA5E05AEE335F93C93B164ABF164C67C5C2B34F606CF26730665DCBD8DECFA7F2100C18377C075AEC9EA13F0A57A1EBBF8D1752EE90A82622597FAC0295E19645222B10FB9212F7499FADA380E3D0A91749D3B60E9B67CA67186E441BAF5948600092E4514DE45AC60C9D79FEE8958824285A396CD599408DF5066E455A8D8889554D20E5849E9FFB358B9E2EAED690B586A86CF5424003D0B8228086E895220B89601A9EBBE0EB08C43104640249C13559EA53FDFD370074C1690DB179305EC5A315900B60F26CFA48C7C9AEA500765717ED39C0B1E389B94C91C5F1A81CE4720D218A187278FDD1F2CFF74082C6F5C25304FAB1B058EBC9A35F6C5C3E74F118AD8AA0CFD9C2EC24AB55C427CD9F27B28736098BA6BA1335046482B3F3755B74C6FB21759CA62CF5D69B0D72C356494D0A991B441CBBCEE5B825BEA5BA9EAF5145184B326A2D0D1CC264DB35AF05B06B12A5EBCAC7A29AA1CAFA3CC195D9338C694502B7BF2156796D73C6F66BB17046126C3F3654B5D506A5B9E84098E2CC1D8AD257A4C25644E74529A04A145D6806C079E8AA31AA8B42355A0AC20D79F3396B602C5145039EF12ED09313DA7A68119629B2FAD360923A2E59D98442C0979D75BB3893BCBFC75FE6CC59630F20CC54DD778966F0C8C9A9EEE1587FCCE7C411CB23CB07B1C3AF8BE761CBA24349ED7BAA0C6C6E1E3DACC4C2DC12DF3EEE6089664AD716ABD343AAFB6D5B4468AB65DD22BC099A8B6306B979407EFA8539EF3F7D42915B2A34EE6E36147D17A434C921243E55B62BC19A33C7FEFD03F17093D23711DD4FD051D85C97CB6960AC2812618CC7E63134611B515C135E17401526525BB8B6DECA9D186FF7B5A624FCA80F5E98B0FDE7428CAD754BBF50B7A54FE4284FF4CC47721597D5F9764B70B3BB67E077747EA8AAD5DD6617CD5ABB50AF0B34A5BABD773FBDE50DC902A6DE2AE1CB63D5CD531B5A059FDC9150F6035767F4F9986CED52F4F05DF913315984086CEB1F3C7CEC1ACD4362E500F050ADE1D14D8AF2F6D7DF2CCF6637B437A62BDB4537E8E1854E09CF9592E9D10E993C0F69A7E86369E9E777DA60A7DFA583DB98505087D1D09C3D74A2A81EF9555D1DC0ACA7D1A13D6B0DA7E72FB24116D5229CFDC398718B8CE0EB6817D4EDB546194A20DF76E734067AFBF05386D75492D7476D45A03F63F034EFF501E16389BCAC057074EFB90C86ECC7B4C81BA8740591588CFDA5CA7A72C2B76CC425A0744DDF3A136C9ED839A76C95D8AD7373BCFE83061EB90AA9C2E6D9E5575743876C2B7DADEAD33AA86D9661FD67F3CD5CBD8620EB6C5D8F6D6C94E52D6ACE550C6EE308BB3FB25BCA1B55F25314348BAAC44E8DF2839F88DBB59D25CF14554240943A382C42866AE4111AC20C9995074417C85DB3E4899FE30F04858822417E11C822B3E4D549C283419C2396BFCD0A053CDA6F3D3816353E7D1344E87FAAF6102AA4975113CE51F13CA8252EFCB965AAA4384CE6179B9AF63A974D9BF5C97926E22DE5350EEBE32F5DE4318331426A77C465E601FDD1E247C8225F1D745DBDB2D647B209A6E1F9D53B2142494B98C8A1FBF22868370F5FE1FC846384A9C1F0000 , N'6.3.0')
END

IF @CurrentMigration < '201911010003340_OneGenrePerVideo'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [tinyint]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201911010003340_OneGenrePerVideo', N'CodeFirstVidzy.Migrations.Configuration',  0x1F8B0800000000000400D559DB6EE336107D2FD07F10F4D416592B9797AD61EF22EB2485D1CD055112F42DA0A5B143942255920AEC2DFA657DE827F5173AD45D94EC48DE6EB64580C021670EE77238C371FEFEF3AFC9FB75C49C67908A0A3E758F4687AE033C1021E5ABA99BE8E59BB7EEFB77DF7E33390FA3B5F350C89D1839D4E46AEA3E691D8F3D4F054F1011358A682085124B3D0A44E4915078C787873F7A47471E20848B588E33B94DB8A611A47FE09F33C103887542D8A50881A97C1D77FC14D5B92211A89804307567287141A5D20F34FCB4719D5346095AE1035BBA0EE15C68A2D1C6F1BD025F4BC1577E8C0B84DD6D6240B925610A72DBC795785F370E8F8D1B5EA558400589D2221A08787492C7C5B3D5F78AAE5BC60D23778E11D61BE3751ABDA9FB1370899EDB278D674C1A293BB2A354FEC069AE1E941C40AA981F1448984E244C39245A1276E0DC240B46839F6173277E053EE5096375CBD036DC6B2CE0D28D143148BDB985656EEF3C741DAFA9E7D98AA55A4D2773E6C346A3B3577836593028F3EEED5437BF0B00240FDE01D7B924EB8FC057FA69EAE247D7B9A06B088B951CF59E53BC32A8A465D23EE48A3CD3551A6BEB388C2808E53AB7C0D26DF544E38CC9A374EB314FD98514D1AD608546B6FC7847E40A349A2BDA7BBE4864605932F12A4AEC244A0A348028A9FCFF962873AE4F8E3B985273DCD74202061624D110DE10AD4172830169E8BE0EABAC43904340149C115D9E653EDFD168002173BEEDC7C782735D7C2CB8DA878FA74A8980A606D409991FDEF4E49C87CE0E4BB29097F663D891823446D2E1B953F7875664BAF1CA9B56E1E59168E21D8E4647B68F356FDA970EFB9E2614795539FA295D84B5EEB880D8D2F23BA87252D8D61B501F743D9D585FAA3837AD6F39DF542FCA534B3D0FA6A55EF3D4C228785393E8A0957DD177E7B634B6B2D3EB875064B3865004CAAE224D973AB85B26B07AB178D993A578DA785BDE36934B12C7580A6A6F9D7CC5F1F387CE1B7FF82B20CA30BC40753C064A6BCB93B0B0911558BBB5028F25842C882946B3306A8935E8BA854BC5510D46B6135530AC10379F3395AE57890D5005EF02FD89B02CA7AE819DE2B65EFAC4248CC88EFE30132C89F8B61EB34B3BABF875FD6CA58D30F12CC3EDD078ADD8581CB523DD2B0FF995F98C3C643560781EB6E87DED3C6C4368B4D53A5063E3F5F3DAAC4C1DC92D6AEEEE041652BDB264EA69D70BB65957DBA1E895D80CA32BBD2614E5B9C34CCA9BC59E260D36064B6148D377CB5C99F764F992EBE3A8DD6DDA696F351D5BA4245DD97CAC2633C90BFE8029BBE8009988EBA0EFCF1861ACFEFE466988464660E4FFC6668C22CD2B814BC2E91294CEDEF62E0EBBC7D6B0FEDF199C3DA542D6677A7EF5E94453BEA126AC9F31C9F26722832722BF8BC8FAFB3A527BAE183823BE7A38D250BC388EBD4EAC7ACD60217ED6E90C360CAAAA12160F5A43C19C87B09EBABFA78A6367FECB63A17BE05C4BBC8863E7D0F963BFB4EF378AD53ACFB069A9FD64DF678643AE813454200C2BA5D2126B65ABFDDEE0181ED098B086CDED46D187C0267E259EBD73063170C3CC865B7D0EDAD5114B54EB26BDE4FBC079B43D07F41838B7CF9B590FC14BB13089CDC8B865F4EA9C45B78FA25DC8DD63E1171C531BDED7868E1707D3F634FB6546D176F747C6D4BE8947B22ABAAA20CC838643D0E04A2933E74B5190D6B2A810B16ADA256882F5909C4A4D9724D0B81D8052E9F7610F842528721E2D209CF3EB44C7894697215AB0C6F76B86FABBCE4FE7EDA6CD93EB38FD32EBDF7001CDA4A6A45FF30F09656169F745BBCF6C8330772A6F5E2697DA34B1D5A644BA12BC27501EBEB214DC4114330453D7DC27CFB08F6DF70A3EC28A049BE211B71DE4E54434C33E39A3642549A4728C4ADFFC77C933FF5E7AF70F62156B8E901A0000 , N'6.3.0')
END

IF @CurrentMigration < '201911010008061_AddClassificationTableAndClassificationColumnToVideo'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [int] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201911010008061_AddClassificationTableAndClassificationColumnToVideo', N'CodeFirstVidzy.Migrations.Configuration',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D6B2934B1BD8BBC83AC9C2E83A09A224E82DA0A5B14394A254920AEC167DB21EFA487D850E25EA8F921DD9BB9B6DB1C0C2226786F3F3717E987FFEFA7BFC6E1D31E71984A4319FB8A3C1D07580077148F96AE2A66AF9E647F7DDDB6FBF195F84D1DA7928E84E341D727239719F944A4E3D4F064F10113988682062192FD52088238F84B1773C1CFEE48D461EA008176539CEF836E58A46907DE0E734E601242A256C1E87C0A459C71D3F93EA5C910864420298B853A4B8A442AA071AFEBE719D3346096AE1035BBA0EE13C5644A18EA7F7127C2562BEF2135C20EC6E9300D22D099360743FADC8FB9A313CD666781563212A48A58AA33D058E4E8C5F3C9BFD20EFBAA5DFD07317E861B5D15667DE9BB81F800BB4DC3EE974CA84A6B23D3BC8E88F9CE6EA518901848AFE87042953A98009875409C28E9C9B74C168F0336CEEE25F814F78CA585D33D40DF71A0BB87423E20484DADCC2D2E83B0B5DC76BF2793663C956E3C98D79BF5168EC159E4D160CCAB87B3BD9F5FF8500040FDE01D79993F547E02BF53471F1A7EB5CD23584C58A917ACF295E196452226D1F72459EE92AF3B5751C7A1462E93AB7C0B26DF944931CC9836CEBD184EC52C4D16DCC0A8E7CF9F18E88152854376EEFF9712A024B93B1574162275032417B0025A3FFDF0265C6D5C97107526A86FB2A16808E05411484374429105CCB80CC755F0755D62188212012CE892ACFD2BFEF68F422EB941129E9920626F3184D350CEDAD97EED356A81B241F86F402CD5D482F6E413FA4A7510DE7B6713379C9C8AAAA11BD2F4053D0E7BA0918FF1004DB205EEA486D3A7C0ED1028431C8A70C2BB9EB3C1096E2E7A8159E06F587988525EDF16EDA1B1D36F45E497FD2F678EEDBFAE29994714033A7D4538B0976F3B80B1E3A3B225F41D264A739BA9026E8348CF3C4FDA1A57EB7BC326756F20CF29AF28683C1C8B6B0664D3B7D6207A308E5A5C3B2C8EB4558AB0E24617362C024CDF5B6B5D7427D50F5EB8395A2C27553FB96F14DF6A2D0B4D88D332DF69AA5968CE29ED6283AAEB19DB277C7B654B6D2D3EB27A188664D42E128BB1E344DEAC8156500ABDED3CB9BCFA249F5B674A9E3394912BCA4B5AED5AC38BE6959DFF8FBF773512EC30B64475B576A5B9E84258AACC0DAAD652A2C066441745A9B86518BAC01D72D582A8E6A20B21DA8026105B9FE6DF26D477F690BA89C7789F644586033D3C00E719B2F1B160823A2A3D24F6396467C5BB7B08B3BAFDD75FE7CA52D61EC598ADBAEF15ABEB1306A7BBA571CCC95F98438E43960FF386CE1FBDA71D826A1D120D5053536FACBB3BB87BA487BEFF5D1D2CC771D902932F96E581454BD62AFB374D784D3CCD66D57F4824B2EA30B34DA15E5B9FBA9644AD0812AEDAD0C26D89066DDD04CEA4EBAEC34FB186AD7B076D85BA5CC262941579634AB748D4D19D9E315A6A82B3989EBA0EDCFE861AC29FE462A88069A60E0FFC6A68C22CC2B8239E1740952E51DAF7B3C1C1D5B8F39FF9D87154FCA90F5795D79F5E915BB721C10D427BD74F06722822722BE8BC8FAFBBAA4F6DCB9E71BC2ABBB2373C58BE3FAEBF8AAD78C1EE26F95CDE8FB89EA9ED90F4142956F2C44B5869619CEA3EB89FB47C678EACC7E792C788F9C6B8157FAD4193A7F1E06A0C346C55A0DDB6F9A6B8F1487CC98885A101A548461CE9538CAD37621BF1194073421ACA173BBE4F4B90ADA7FA53C7BE71C12E01AE30DB3FA1CB4ABB69652AD3BF992ED7BCECBED39A5C740BC7D1ECEAB115EAF850E6C0EC62DA361E7ACBC7D54EE92DC3DB67EC131BA617D6D287A71706E4FDB5F66546EF7118898DADF7C10AC92AE2A11BA35E21034B052D2CCF8322E406B69549058396D0E8A6066256742D12509146E0780F952BFBC9A07AC8B6801E18C5FA72A49159A0CD182355E7235F4779D9FBD0734751E5F27D9E3E6E73001D5A4BA385CF3F729AD3DD45DB673FA3611FA4E9932A863A974395C6D4A495731EF29C8B8AF4C057710250C85C96BEE93673844B77B091F6145824DD10E6E17F272209A6E1F9F53B21224924646C58F9F88E1305ABFFD174DF3979FFA1C0000 , N'6.3.0')
END

IF @CurrentMigration < '201911012342040_Exercise5FluentAPIChanges'
BEGIN
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](max) NOT NULL
    DECLARE @var2 nvarchar(128)
    SELECT @var2 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Classification';
    IF @var2 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var2 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Classification] [tinyint] NOT NULL
    DECLARE @var3 nvarchar(128)
    SELECT @var3 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var3 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var3 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [tinyint] NOT NULL
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201911012342040_Exercise5FluentAPIChanges', N'CodeFirstVidzy.Migrations.Configuration',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D64A1C2CD006F62EB2DE6461749D045112F416D0D2D8214A512A4905768B3E590F7DA4BE428712F547498EED24DB2E02043639F3919CF9663843FFF3D7DFA3F7AB88398F20248DF9D83D1A1CBA0EF0200E295F8EDD542DDEFCE8BE7FF7ED37A3B3305A397785DCB196434D2EC7EE8352C989E7C9E001222207110D442CE3851A0471E49130F68687873F7947471E20848B588E33BA4EB9A211645FF0EB24E601242A256C1687C0A419C7193F43752E48043221018CDD094A9C5321D51D0D7F5FBBCE29A30477E1035BB80EE13C5644E11E4F6E25F84AC47CE9273840D8CD3A01945B1026C1ECFDA412DFF61887437D0CAF522CA08254AA38DA11F0E8D8D8C5B3D5F7B2AE5BDA0D2D778616566B7DEACC7A63F713708127B7573A9930A1A56CCB0E32F903A7397A507200A9A2FF5020652A1530E6902A41D8817395CE190D7E86F54DFC2BF0314F19ABEF0CF786738D011CBA12710242ADAF6161F63B0D5DC76BEA79B662A956D3C90FF361ADF0B017B836993328FDEE6D54D7FF0B00240FC680EBCCC8EA33F0A57A18BBC3B76F5DE79CAE202C460CEA2DA71832A8A444BAC5AA17E4912E33E35BEBA3892196AE730D2C9B960F34C9A93DC8A6EE8D0FCF451C5DC7ACD0C887EF6F885882C2FDC7ED393F4E4560ED64E4551CD9C89C0C6807E664F25F2D73A65C1D0F3B9C583BB8AF6201685810444178459402C1350664A67B26CDF0E38BD0CC5A15490544C247A2CAC5F5E71B1A3DA93A61444ABAA081C94D66EB9A97F6D48E9BCAD8B96BD4F6C68F098FFDC2A70891AEF029426BBBF049A35AF0D8069ACA734696D54DB4755435815E2ABC90542108B64612D65CD0B4F70CA23908731E9F322C175CE78EB014BF1EB5BCD390FE14B3B0941D6E96BDD25E43E395F2C76D83E7A6AD0F9E4A190734B3493D5D195F37973BE3A1B3C1F115AB4DC69BA10569823643378FDD1F5ADBEFC62BF370856788D7C46B9B0E5318089D4308C39248A2D72857ED7C47794013C2FA97B654B64C92DAC225B83DF31112E03ABFF51B709B55CB786F2F5DAE6065EEA78C32F26A1468DF63A8A350A36459162D7A1056AA23FAB06C3401284D9EB55DAE417D50F503E1955DE582A6CB5B8C69AA17377E4BDD30D052AF9DD4C228725B4DA223F5D946DF1C10E566AB7DB6DCB639046A0885A1EC8BB979A48EFC5A3AB0EA0ABCBC2D28DA07AFA77F18CD48926062ABF51366C4F14D33F1C6DFBDD28E720C2F901D0577B9DB7225AC15C812ACD95A76C74B98CC89BE0A2661D4126BD0B5874BC5520D46B61D5530AC10D79FCD1DD551F97784B3513CC7F3443A13646590EDE2B65ED6C611464447C93589591AF1FE8CD4AF9D175175FD7CA48D30F2AC8DB7524FCB3616476D4B6FE5071332CFF0439E0376F7438FDE7FED873E8446615A076A4C6C8F67575C75487B6E7BD4F2E6AAC3F55E67AFCCBA566EB445CAD5CB1C69E5C291C94B3B3CB814892A17711D34D023320D9394BF960AA2811618F8BFB109A378DE4A6046385D805479D9E90E0F8F86D6BBCDFFE70DC5933264DB3CA47CF1BE146B63ACD2D5B31E35F82311C10311ED678D8DA03BBE147C71D3646679B2297F01BB7D1791D5F72FD17987F859659D77859577F5FB74E2FB52C3EABE4B9856553CC5C27C3576FFC8F44E9CE92FF746F5C0B91418E127CEA1F3E79E24DAAF8133E5EEEE3D9655B0EED3F6EDD5A6F51555AFD3997D25CD58BB08DEA2DBEA6FB6F29B09A36BAEFD9A33B1A7EFE86CC4FAFBB02EE4EE9EE8157BB4C6E96B15F7935D59BB957B9D3EAC5D5320636A3FF52057255D5610FA871F0E41832BA5CC942FE282B3D68E0A112B9DCD40114CACE45428BA2081C2E900305DEAF755F3A47416CD219CF2CB5425A9C2234334678DF75A4DFD4DEB67CD6673CFA3CB247B6D7C8923E036A9BE1B2EF98794D69ECECE3BF2690F848E29730D6A5F2A7D1D2ED725D245CCB70432E62B53C10D4409433079C97DF208FBECED56C2675892605D9486FD204F3BA269F6D1474A968244D26054FAF815391C46AB77FF02D88125C0F11C0000 , N'6.3.0')
END

